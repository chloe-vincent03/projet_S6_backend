import{u as k,_ as V}from"./41ABSLID.js";import{_ as A}from"./2d5tmkDm.js";import{r as z,l as $,x as I,c as b,o as x,_ as U,B as j,w as f,q as S,a as h,F as q,s as D,J as T,T as X,g as Y,A as C,n as H,b as m,v as E,d as w,P as J,y as W}from"./FsFn14e0.js";import{u as B}from"./LQRTUvHo.js";import"./BJ2ClxiI.js";const Z="59, 130, 246",L=60,K={__name:"SharedMagicCursor",setup(y){const s=z(null);let r=null,d=null,n=[],v=0,a=0;class l{constructor(e,i){this.x=e,this.y=i,this.size=Math.random()*3+1,this.life=L,this.vx=(Math.random()-.5)*1,this.vy=(Math.random()-.5)*1}update(){this.x+=this.vx,this.y+=this.vy,this.life--,this.size*=.95}draw(e){const i=this.life/L;e.fillStyle=`rgba(${Z}, ${i})`,e.beginPath(),e.arc(this.x,this.y,this.size,0,Math.PI*2),e.fill()}}const c=()=>{s.value&&(v=window.innerWidth,a=window.innerHeight,s.value.width=v,s.value.height=a)},p=o=>{for(let e=0;e<2;e++)n.push(new l(o.clientX,o.clientY))},u=o=>{for(let e=0;e<12;e++){const i=new l(o.clientX,o.clientY),g=Math.random()*Math.PI*2,_=Math.random()*3+2;i.vx=Math.cos(g)*_,i.vy=Math.sin(g)*_,i.life=L*1.5,n.push(i)}},t=()=>{if(r){r.clearRect(0,0,v,a);for(let o=0;o<n.length;o++)n[o].update(),n[o].draw(r),n[o].life<=0&&(n.splice(o,1),o--);d=requestAnimationFrame(t)}};return $(()=>{s.value&&(r=s.value.getContext("2d"),c(),window.addEventListener("resize",c),window.addEventListener("mousemove",p),window.addEventListener("mousedown",u),t())}),I(()=>{window.removeEventListener("resize",c),window.removeEventListener("mousemove",p),window.removeEventListener("mousedown",u),cancelAnimationFrame(d)}),(o,e)=>(x(),b("canvas",{ref_key:"canvasRef",ref:s,class:"fixed inset-0 pointer-events-none z-[9999]"},null,512))}},Q={key:0,class:"fixed inset-0 z-[9000] pointer-events-none overflow-hidden"},ee=5e3,te=20,ne={__name:"SharedGuardiansOfSilence",setup(y){const s=z(!1);let r=null;const d=v=>{const a=Math.random()*100+"%",l=Math.random()*100+"%",c=Math.random()*6+4+"px",p=Math.random()*10+10+"s",u=Math.random()*-20+"s",t=Math.random()*.4+.6;return{top:a,left:l,width:c,height:c,opacity:t,animationDuration:p,animationDelay:u,boxShadow:`0 0 ${Math.random()*15+10}px #3B82F6`}},n=()=>{s.value&&(s.value=!1),clearTimeout(r),r=setTimeout(()=>{s.value=!0},ee)};return $(()=>{window.addEventListener("mousemove",n),window.addEventListener("mousedown",n),window.addEventListener("keypress",n),window.addEventListener("wheel",n),window.addEventListener("touchmove",n),n()}),I(()=>{window.removeEventListener("mousemove",n),window.removeEventListener("mousedown",n),window.removeEventListener("keypress",n),window.removeEventListener("wheel",n),window.removeEventListener("touchmove",n),clearTimeout(r)}),(v,a)=>(x(),j(X,{name:"fade-slow"},{default:f(()=>[s.value?(x(),b("div",Q,[(x(),b(q,null,D(te,l=>h("div",{key:l,class:"absolute rounded-full bg-[#3B82F6] blur-[2px] animate-float",style:T(d(l))},null,4)),64)),a[0]||(a[0]=h("div",{class:"absolute inset-0 bg-radial-gradient opacity-20"},null,-1))])):S("",!0)]),_:1}))}},oe=U(ne,[["__scopeId","data-v-89b3f4ad"]]),se=()=>(B("auth_token"),{calculateProgress:(s,r)=>{if(!s||!s.unlockedFragments||!r)return 0;const d={};r.forEach(a=>{const l=a.totem_id||1;d[l]||(d[l]=[]),a.reward&&a.reward.fragment_id&&d[l].push(a.reward.fragment_id)});let n=0;const v=Object.keys(d).length;return Object.keys(d).forEach(a=>{const l=Number(a),c=d[l]||[];if(c.length===0)return;c.every(u=>s.unlockedFragments.some(t=>String(t.fragmentId)===String(u)))&&n++}),v===0?0:Math.min(n/v,1)}}),ae={key:0,class:"fixed top-0 left-0 right-0 z-50 bg-white/80 backdrop-blur-md shadow-sm border-b border-white/50 px-6 py-4 flex items-center justify-between transition-all"},re={class:"flex items-center gap-6"},ie={class:"w-full py-8 mt-auto bg-white/50 border-t border-stone-100 backdrop-blur-sm"},le={class:"container mx-auto px-6 text-center"},de={class:"flex flex-wrap justify-center gap-6 mb-4 text-sm font-medium"},he=Y({__name:"default",setup(y){const s=H(),r=B("auth_token"),{calculateProgress:d}=se(),{data:n,refresh:v}=k(`${s.public.apiBase}/user/profile`,{headers:C(()=>({Authorization:`Bearer ${r.value}`})),lazy:!0,server:!1,watch:[r]},"$sBXLId4RTz"),{data:a}=k(`${s.public.apiBase}/enigmas`,{lazy:!0,server:!1},"$Zav9sUhl7G"),l=C(()=>!n.value||!a.value?0:d(n.value,a.value)),c=(u,t,o)=>{const e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(u),i=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);if(!e||!i||!e[1]||!e[2]||!e[3]||!i[1]||!i[2]||!i[3])return u;const g=parseInt(e[1],16),_=parseInt(e[2],16),M=parseInt(e[3],16),F=parseInt(i[1],16),P=parseInt(i[2],16),G=parseInt(i[3],16),N=Math.round(g+o*(F-g)),O=Math.round(_+o*(P-_)),R=Math.round(M+o*(G-M));return`rgb(${N}, ${O}, ${R})`},p=C(()=>c("#2C3E50","#93C5FD",l.value));return(u,t)=>{const o=V,e=A;return x(),b("div",{style:T({"--theme-dynamic":p.value})},[m(o,null,{default:f(()=>[m(K),m(oe)]),_:1}),E(r)?(x(),b("header",ae,[m(e,{to:"/",class:"flex items-center gap-2 hover:scale-105 transition-transform text-dynamic"},{default:f(()=>[...t[0]||(t[0]=[h("span",{class:"text-2xl font-bold tracking-widest",style:{"font-family":"'Cinzel', serif"}},"La Ville Lente",-1)])]),_:1}),h("nav",re,[m(e,{to:"/grimoire",class:"font-medium text-stone-600 hover:text-stone-900 transition-colors","active-class":"!text-stone-900 font-bold"},{default:f(()=>[...t[1]||(t[1]=[w(" Grimoire ",-1)])]),_:1}),m(e,{to:"/map",class:"font-medium text-stone-600 hover:text-stone-900 transition-colors","active-class":"!text-stone-900 font-bold"},{default:f(()=>[...t[2]||(t[2]=[w(" Carte ",-1)])]),_:1}),m(e,{to:"/profile",class:"px-4 py-2 rounded-full border border-stone-200 bg-white hover:bg-stone-50 transition-all shadow-sm hover:shadow-md text-sm font-bold text-stone-700","active-class":"border-stone-400"},{default:f(()=>[...t[3]||(t[3]=[w(" Mon Profil ",-1)])]),_:1})])])):S("",!0),h("main",{class:W([{"pt-20":E(r)},"flex-grow min-h-[calc(100vh-80px)]"])},[J(u.$slots,"default")],2),h("footer",ie,[h("div",le,[h("div",de,[m(e,{to:"/mentions-legales",class:"text-stone-500 hover:text-dynamic transition-colors"},{default:f(()=>[...t[4]||(t[4]=[w(" Mentions Légales ",-1)])]),_:1}),m(e,{to:"/cgu",class:"text-stone-500 hover:text-dynamic transition-colors"},{default:f(()=>[...t[5]||(t[5]=[w(" CGU ",-1)])]),_:1}),m(e,{to:"/politique-confidentialite",class:"text-stone-500 hover:text-dynamic transition-colors"},{default:f(()=>[...t[6]||(t[6]=[w(" Politique de Confidentialité ",-1)])]),_:1}),m(e,{to:"/contact",class:"text-stone-500 hover:text-dynamic transition-colors"},{default:f(()=>[...t[7]||(t[7]=[w(" Contact ",-1)])]),_:1})]),t[8]||(t[8]=h("p",{class:"text-xs text-stone-400"}," © 2026 La Ville Lente. Tous droits réservés. ",-1))])])],4)}}});export{he as default};
