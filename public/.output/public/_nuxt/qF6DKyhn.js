import{_}from"./CMZabeNq.js";import{g as v,r as c,c as u,a as o,C as h,q as C,D as m,E as f,v as s,G as x,t as E,d as g,b as k,w as N,o as p,n as S,H as T}from"./17CJ-4L8.js";import{u as V}from"./HbBEbhl-.js";import"./BJ2ClxiI.js";const M={class:"min-h-screen flex items-center justify-center bg-gradient-to-br from-[#f4f6fb] to-[#e9ecf5] p-4 font-sans"},j={class:"w-full max-w-md bg-white rounded-2xl p-8 shadow-[0_20px_40px_rgba(0,0,0,0.08)]"},q={class:"flex flex-col gap-1.5"},B={class:"flex flex-col gap-1.5"},D={key:0,class:"text-red-500 text-sm text-center bg-red-50 p-2 rounded"},O={class:"flex flex-col items-center gap-4 mt-4"},J=["disabled"],R={key:0},U={key:1},A={class:"text-sm text-gray-600"},F=v({__name:"login",setup(L){const n=c(""),a=c(""),l=c(!1),i=c(""),y=S(),w=V("auth_token",{maxAge:3600*24});async function b(){l.value=!0,i.value="";try{const r={email:n.value,password:a.value},e=await fetch(`${y.public.apiBase}/user/login`,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(r)}),d=await e.text();let t;try{t=JSON.parse(d)}catch{throw console.error("Réponse non-JSON reçue:",d),new Error(`Erreur serveur (${e.status})`)}if(!e.ok)throw new Error(t.message||"Erreur lors de la connexion");if(t.token)w.value=t.token,await T("/map");else throw new Error("Token manquant dans la réponse")}catch(r){console.error("Erreur connexion:",r),i.value=r.message||"Une erreur est survenue."}finally{l.value=!1}}return(r,e)=>{const d=_;return p(),u("div",M,[o("div",j,[e[6]||(e[6]=o("h1",{class:"text-3xl font-bold text-center mb-8",style:{color:"#2C3E50"}}," Connexion ",-1)),o("form",{class:"flex flex-col gap-5",onSubmit:h(b,["prevent"])},[o("div",q,[e[2]||(e[2]=o("label",{for:"email",class:"text-sm font-medium text-gray-700"}," Email ",-1)),m(o("input",{id:"email","onUpdate:modelValue":e[0]||(e[0]=t=>x(n)?n.value=t:null),type:"email",placeholder:"exemple@test.com",required:"",class:"w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 outline-none transition-all placeholder-gray-400",style:{"accent-color":"#2C3E50","caret-color":"#2C3E50"}},null,512),[[f,s(n)]])]),o("div",B,[e[3]||(e[3]=o("label",{for:"password",class:"text-sm font-medium text-gray-700"}," Mot de passe ",-1)),m(o("input",{id:"password","onUpdate:modelValue":e[1]||(e[1]=t=>x(a)?a.value=t:null),type:"password",placeholder:"Mot de passe",required:"",class:"w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 outline-none transition-all placeholder-gray-400",style:{"accent-color":"#2C3E50","caret-color":"#2C3E50"}},null,512),[[f,s(a)]])]),s(i)?(p(),u("div",D,E(s(i)),1)):C("",!0),o("div",O,[o("button",{type:"submit",disabled:s(l),class:"w-full py-3 px-4 disabled:bg-gray-400 text-white font-bold rounded-lg shadow-lg hover:shadow-xl transition-all transform hover:-translate-y-0.5 flex justify-center items-center",style:{"background-color":"#2C3E50"}},[s(l)?(p(),u("span",R,"Connexion...")):(p(),u("span",U,"Se connecter"))],8,J),o("p",A,[e[5]||(e[5]=g(" Pas encore de compte ? ",-1)),k(d,{to:"/register",class:"font-medium hover:underline transition-colors",style:{color:"#2C3E50"}},{default:N(()=>[...e[4]||(e[4]=[g(" Créer un compte ",-1)])]),_:1})])])],32)])])}}});export{F as default};
